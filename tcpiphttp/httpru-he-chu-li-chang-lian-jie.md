### 

### 短连接：

连接——&gt;传输数据——&gt;关闭连接

HTTP是无状态（什么是无状态？后面会解释）的，浏览器和服务器每进行一次通信，就建立一次连接，但通信结束就中断连接，这就是短连接。

也可以这样说：短连接是指socket连接后，发送接收完数据后马上断开连接。

**无状态**的意思是：HTTP协议不具备保存之前发送过的请求或响应的功能。每次的请求是相互独立的，第n次的请求结果和第n-1次、第n+1次的请求结果不会互相影响，服务器也不会保存客户端的状态，客户端必须每次带上自己的状态去请求服务器。

但是：

1. 通过设置cookie和session，现在的网络请求其实是有状态的
2. 在没有状态的http协议下，服务器会保存客户端每次网络请求对数据的修改，但这跟保留每次访问的数据是不一样的，保留的只是回话产生的结果，而没有保留回话

### 长连接：

连接——&gt;传输数据——&gt;保持连接——&gt;传输数据——&gt;......——&gt;直到某一方关闭连接（一般是客户端关闭连接）

长连接是指建立连接后，不管是否使用都保持连接，但安全性较差

### HTTP长连接与TCP/IP长连接的关系

**HTTP的长连接和短连接本质上是TCP的长连接和短连接。**HTTP属于应用层协议，在传输层使用TCP协议，在网络层使用IP协议。IP协议主要解决网络路由和寻址问题，TCP协议主要解决如何在IP层之上可靠的传输数据包，使得接收方收到发送方的所有包，并且顺序与发送顺序一致。TCP协议是可靠的、面向连接的。

在HTTP1.0中默认使用短连接。

从HTTP1.1开始，默认使用长连接。使用长连接的HTTP协议，会在响应头加上这行代码：

```
Connection:keep-alive
```

keep-alive不会使客户端和服务器永久保持连接，它会有一个保持时间，可以在不同的服务器中设定这个时间。实现长连接需要客户端和服务器都支持长连接。

### 长连接和短连接比较：

| **连接类型** | 优点 | 缺点 |
| :--- | :--- | :--- |
| 短连接 | 管理较为简单，存在的连接都是有用的连接，不需要额外的控制手段。 | 如果客户端请求频繁，将在TCP的建立h额关闭操作上浪费较多的时间和宽带。 |
| 长连接 | 省去较多的TCP建立和关闭操作，减少浪费，节约时间。 | 随着客户端的连接越来越多，服务器会保持过多的连接。解决方法就是：1.关闭一些长时间没有发生请求的连接；2.限制每个客户端的最大连接数，避免恶意的客户端拖垮服务器。 |



